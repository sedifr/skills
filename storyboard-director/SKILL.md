---
name: storyboard-director
description: "将剧本转为通用影视分镜工作流：生成文字镜头表并审查冻结；生成参考图并审查冻结；生成分镜帧并审查冻结；回填与整理；按需导出 PDF/PPTX。用户提到\"我要做分镜\"、\"帮我拆分镜\"、\"把这段剧本做成分镜\"、\"分镜导演\"时使用；严格 one-question-per-turn，先文字后出图，分批生成与审片，控制一致性与成本。"
---

# Storyboard Director (分镜导演)

把剧本拆成可以执行、可以回放、可以审片的分镜流程。核心原则是: 先文字分镜, 冻结通过后再进入出图与导出。

## Quickstart

对话里直接说下面任意一句即可:

- 我要做分镜
- 帮我拆分镜
- 把这段剧本做成分镜
- 使用 storyboard-director 按流程执行

然后严格按 one-question-per-turn 推进。

## Execution rules

- 每回合只问 1 个关键问题；不要在同一条消息里塞多个确认。
- 未明确“文字分镜通过”前，不生成任何图片。
- 未明确“参考图通过”前，不生成任何分镜帧图。
- 每次生成图片前，必须让用户指定生成范围（如 `01-03` / `05,07` / `全部` / `仅新增`）。
- 输出路径与命名保持一致，避免覆盖，保留版本号（如 `01_v2.jpg`）。

## Inputs (what to ask for)

- 项目名称
- 画幅 (比例或像素)
- 剧本 (支持分段粘贴)
- 文字镜头表字段是否增删 (默认字段见 `references/fields.md`)
- 本次生成范围 (只对指定镜头生成)

## Workflow

按 `references/state-machine.json` 的 steps 顺序执行, 并在以下节点强制停下等待用户确认:

- 文字镜头表生成后: 冻结审查
- 参考图生成后: 冻结审查
- 分镜帧生成后: 冻结审查

## Output expectations

### 文字镜头表 (XLSX/JSON)

- 每个镜头必须能在不看上下文的情况下被执行 (地点/时间/景别/机位/运镜/人物/动作/台词/连续性)
- 同一场景的连续镜头必须标注连续性注意事项 (轴线/方位/光向/道具位置)

### 分镜帧图

- 镜头号命名: `01.jpg`, `02.jpg` ...
- 版本命名: `01_v2.jpg`, `01_v3.jpg` ...
- 变更必须写明原因 (例如构图不清/动作不对/人物不一致/信息点不足)

### 可选导出

- PDF/PPTX 按用户指定的每页格数与字段显示

## Example (typical session)

用户:

"我要做分镜。画幅 16:9。下面是第一段剧本: ..."

你:

"本次项目名称是什么?"

用户:

"夜班便利店"

你:

"文字分镜表列字段是否沿用默认全字段? (默认字段清单见 references/fields.md)"

用户:

"默认就行。"

你:

"我已生成文字分镜表。请审查: 哪些镜头需要合并/拆分/调整景别机位运镜/补动作台词?"

## References

按需读取:

- `references/state-machine.json`: 每步提问/自动步骤定义
- `references/fields.md`: 文字分镜表默认字段清单
## Outputs

- 文字分镜表 (XLSX) 与结构化镜头表 (JSON)
- 参考图 (场景/人物一致性资产)
- 分镜帧图 (按镜头号命名, 支持版本号)
- 可视化导出 (PDF/PPTX, 可选)
